=Module <<a_api_type subproject="server" | module Eliom_state >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|Eliom_state>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api subproject="server" text=".." | module Eliom_state >><<span class="ocsforge_color_keyword"|end>>>>~Storing server~-side values for your applications or sessions~.

----

**~Please read the
    <<a_manual chapter="server-state" | Eliom manual >>
    before this page to learn how server side state works~. **


<<outline| <<header| **Table of contents** >> >>


==@@id="2_Managingthestateofanapplication"@@~Managing the state of an application==



===@@id="3_Closingsessionsremovingstatedataandservices"@@~Closing sessions~, removing state data and services===

<<pre id="VALdiscard" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >>[< `Client_process of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\         | `Request\\         | `Session of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\         | `Session_group of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Delete server~-side ~(volatile and persistent~) state data and services
    for a session~,
    a group of sessions~, a client process or a request~.


    ~Use that function to close a session
    ~(using scope <<span class="odocwiki_inlinecode"|~Eliom~_common~.default~_session~_scope>>~)~.


    ~Closing a group of sessions will close all sessions in the group~.


    ~By default will remove both secure and unsecure data and services~, unless
    <<span class="odocwiki_inlinecode"|~~secure>> is present~.


    //~Warning~: you may also want to unset some request~-scoped ~Eliom references
    when discarding a state~.//
>>
<<pre id="VALdiscard_all_scopes" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_all~_scopes>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALdiscard_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?persistent: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| scope: >>[< `Client_process of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\         | `Request\\         | `Session of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\         | `Session_group of <<a_api subproject="server" text="Eliom_common.scope_hierarchy" | type Eliom_common.scope_hierarchy >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Remove current state data~.


    ~If the optional parameter <<span class="odocwiki_inlinecode"|~?persistent>> is not present~, will
    remove both volatile and persistent data~. ~Otherwise only volatile
    or persistent data~.
>>
<<pre id="VALdiscard_services" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_services>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >>[< <<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Remove all services registered for the given scope ~(the default being
    <<span class="odocwiki_inlinecode"|`~Session>>~)~.
>>


===@@id="3_Statestatus"@@~State status===


~The following functions return the current state of the state for a given
    scope~:
* <<span class="odocwiki_inlinecode"|~Alive~_state>> means that data has been recorded for this scope
* <<span class="odocwiki_inlinecode"|~Empty~_state>> means that there is no data for this scope
* <<span class="odocwiki_inlinecode"|~Expired~_state>> means that data for this scope has been removed
    because the timeout has been reached~.

    ~The default scope is <<span class="odocwiki_inlinecode"|`~Session>>~.
<<pre class="ocsforge_color odocwiki_code" id="TYPEstate_status"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|state~_status>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_variants"|<<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Alive_state>>>>>><<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Empty_state>>>>>><<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Expired_state>>>>>>>>>><<pre id="VALservice_state_status" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|service~_state~_status>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >>[< <<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="state_status" | type Eliom_state.state_status >>>>>><<pre id="VALvolatile_data_state_status" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|volatile~_data~_state~_status>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >>[< <<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="state_status" | type Eliom_state.state_status >>>>>><<pre id="VALpersistent_data_state_status" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|persistent~_data~_state~_status>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >>[< <<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="state_status" | type Eliom_state.state_status >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>>

===@@id="3_Usercookies"@@~User cookies===



    ~If you want to store a client~-side state~, and ask the browser to
    send it back with each request~, you can set manually your own cookies~.
    ~Usual cookies correspond to scope <<span class="odocwiki_inlinecode"|`~Session>> ~(that is~, one browser~)~.
    ~The browser send them with each request to the same ~Web site~.
    ~But ~Eliom also implements client~-side process cookies
    ~(scope <<span class="odocwiki_inlinecode"|`~Client~_process>>~)~, that behave in the same way~,
    but for one instance of the client~-side ~Eliom program ~(if there is one~)~.


    ~Cookies can be limited to a subsite using the <<span class="odocwiki_inlinecode"|~?path>> optional
    parameter~. ~This path is relative to the main path of your ~Web site~.
    ~(~It is not possible to set a cookie for a subsite larger than your current
    ~Web site~)~.


    ~Cookies can have an expiration date~, specified ~(in seconds
    since the ~1st of ~January ~1~9~7~0~) in the optional parameter <<span class="odocwiki_inlinecode"|~?exp>>
    ~(see how to set default expiration dates below~)~.


    ~Secure cookies are sent by the browser only with ~H~T~T~P~S ~(default~: <<span class="odocwiki_inlinecode"|false>>~)~.
<<pre id="VALset_cookie" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_cookie>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?cookie_level: >><<a_api subproject="server" text="Eliom_common.cookie_level" | type Eliom_common.cookie_level >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?path: >>string list <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?exp: >>float <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| value: >>string <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Ask the browser to record a cookie~.
>>
<<pre id="VALunset_cookie" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_cookie>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?cookie_level: >><<a_api subproject="server" text="Eliom_common.cookie_level" | type Eliom_common.cookie_level >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?path: >>string list <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Ask the browser to remove a cookie~.
>>


==@@id="2_Sessiongroups"@@~Session groups==


~If your ~Web site has users~,
    it is a good idea to group together all the sessions for one user~.
    ~Otherwise~, you may want to group sessions according to another
    criterion~.


    ~Session groups may be used for example to limit
    the number of sessions one user can open at the same time~, or to implement
    a "close all your sessions" feature~.
    ~Usually~, the group is the user name~.


===@@id="3_Puttingasessioninagroupremovingasessionfromagroup"@@~Putting a session in a group~, removing a session from a group===

<<pre id="VALset_service_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_service~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?set_max: >>int <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|sets the group to which belong the service session~.


    ~If the optional <<span class="odocwiki_inlinecode"|~?set~_max>> parameter is present~, also sets the
    maximum number of sessions in the group~. ~Default~: follow current
    configuration for the group or default configuration if the group
    does not exist~.


    ~If <<span class="odocwiki_inlinecode"|~~secure>> is true~, it will affect the secure session ~(secure cookies~)~,
    otherwise ~(default~)~, the unsecure one ~(behavior change in ~Eliom ~4~)~.
>>
<<pre id="VALunset_service_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_service~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?set_max: >>int <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Remove the session from its group~.
    ~Will not close the session if it contains data~.
>>
<<pre id="VALget_service_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_service~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> string option>>>><<div class="odocwiki_info"|returns the group to which belong the service session~.
    ~If the session does not belong to any group~,
    or if no session is opened~, return <<span class="odocwiki_inlinecode"|~None>>~.
>>
<<pre id="VALget_service_session_group_size" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_service~_session~_group~_size>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> int option>>>><<div class="odocwiki_info"|returns the number of sessions in the group~. ~If he session does not
    belong to any group or if no session is opened~, returns <<span class="odocwiki_inlinecode"|~None>>
>>
<<pre id="VALset_volatile_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_volatile~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?set_max: >>int <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|sets the group to which belong the volatile data session~.


    ~If the optional <<span class="odocwiki_inlinecode"|~?set~_max>> parameter is present~, also sets the maximum
    number of sessions in the group~.
    ~Default~: follow current configuration for the group
    or default configuration if the group does not exist~.
>>
<<pre id="VALunset_volatile_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_volatile~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?set_max: >>int <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Remove the session from its group~.
    ~Will not close the session if it contains data~.
>>
<<pre id="VALget_volatile_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_volatile~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> string option>>>><<div class="odocwiki_info"|returns the group to which belong the data session~.
    ~If the session does not belong to any group~, or if no session is opened~,
    return <<span class="odocwiki_inlinecode"|~None>>~.
>>
<<pre id="VALget_volatile_data_session_group_size" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_volatile~_data~_session~_group~_size>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> int option>>>><<div class="odocwiki_info"|returns the number of sessions in the group~. ~If he session does not
    belong to any group or if no session is opened~, returns <<span class="odocwiki_inlinecode"|~None>>
>>
<<pre id="VALset_persistent_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_persistent~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?set_max: >>int option <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|sets the group to which belong the persistent session~.


    ~If the optional <<span class="odocwiki_inlinecode"|~?set~_max>> parameter is present~, also sets the
    maximum number of sessions in the group~. ~When <<span class="odocwiki_inlinecode"|~~set~_max~:~None>> is
    present~, the number of session is unlimited~. ~Default~: follow
    current configuration for the group or default configuration if
    the group does not exist~.
>>
<<pre id="VALunset_persistent_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_persistent~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Remove the session from its group~.
    ~Will not close the session if it contains data~.
>>
<<pre id="VALget_persistent_data_session_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_persistent~_data~_session~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?scope: >><<a_api subproject="server" text="Eliom_common.session_scope" | type Eliom_common.session_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> string option <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|returns the group to which belong the persistent session~.
    ~If the session does not belong to any group~, or if no session is opened~,
    return <<span class="odocwiki_inlinecode"|~None>>~.
>>


===@@id="3_Maximumgroupsize"@@~Maximum group size===


~The following functions of this section set the maximum number of
    sessions in a session group~, for the different kinds of session~.
    ~This won~'t modify existing groups~.
    ~That value will be used only as default value if you do not specify the
    optional parameter <<span class="odocwiki_inlinecode"|~?set~_max>> of function
    <<a_api subproject="server" | val Eliom_state.set_volatile_data_session_group >>~.


    ~If there is no group~, the number of sessions is limitated by sub network
    ~(which can be a problem for example if the server is behind a
    reverse proxy~)~.
    ~It is highly recommended to use session groups!


* ~Default number of sessions in a group~: ~5
* ~Default number of sessions in a sub network~: ~1~0~0~0~0~0~0
* ~Default ~I~P~V~4 sub network~: ~/~1~6
* ~Default ~I~P~V~6 sub network~: ~/~5~6

    ~These default can be changed from configuration file and~/or
    using these functions~.


    ~If <<span class="odocwiki_inlinecode"|~~override~_configfile>> is <<span class="odocwiki_inlinecode"|true>> ~(default ~(<<span class="odocwiki_inlinecode"|false>>~)~,
    then the function will set the value even if it has been
    modified in the configuration file~.
    ~It means that by default~, these functions have no effect
    if there is a value in the configuration file~.
    ~This gives the ability to override the values chosen by the module
    in the configuration file~.
    ~Use <<span class="odocwiki_inlinecode"|~~override~_configfile~:true>> for example if your
    ~Eliom module wants to change the values afterwards
    ~(for example in the site configuration ~Web interface~)~.
<<pre id="VALset_default_max_service_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_service~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of service sessions in a session group
    ~(see above~)~.
>>
<<pre id="VALset_default_max_volatile_data_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_data~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile data sessions in a session
    group ~(see above~)~.
>>
<<pre id="VALset_default_max_persistent_data_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_persistent~_data~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of persistent data sessions in a session
    group ~(see above~)~. <<span class="odocwiki_inlinecode"|~None>> means "no limitation"~.
>>
<<pre id="VALset_default_max_volatile_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile sessions ~(data and service~) in a session
    group ~(see above~)~.
>>
<<pre id="VALset_default_max_service_sessions_per_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_service~_sessions~_per~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of service sessions in a subnet ~(see above~)~.
>>
<<pre id="VALset_default_max_volatile_data_sessions_per_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_data~_sessions~_per~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile data sessions in a subnet ~(see above~)~.
>>
<<pre id="VALset_default_max_volatile_sessions_per_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_sessions~_per~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile sessions ~(data and service~)
    in a subnet ~(see above~)~.
>>
<<pre id="VALset_default_max_service_tab_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_service~_tab~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of tab service sessions in a session group
    ~(see above~)~.
>>
<<pre id="VALset_default_max_volatile_data_tab_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_data~_tab~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile data tab sessions in a session
    group ~(see above~)~.
>>
<<pre id="VALset_default_max_persistent_data_tab_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_persistent~_data~_tab~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of persistent data tab sessions in a session
    group ~(see above~)~.
>>
<<pre id="VALset_default_max_volatile_tab_sessions_per_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_max~_volatile~_tab~_sessions~_per~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile tab sessions ~(data and service~)
    in a session group ~(see above~)~.
>>
<<pre id="VALset_ipv4_subnet_mask" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_ipv~4~_subnet~_mask>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the mask for subnet ~(~I~P~V~4~)~.
>>
<<pre id="VALset_ipv6_subnet_mask" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_ipv~6~_subnet~_mask>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the mask for subnet ~(~I~P~V~6~)~.
>>
<<pre id="VALset_max_service_states_for_group_or_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_max~_service~_states~_for~_group~_or~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of service sessions in the current session
    group ~(or for the client sub network~, if there is no group~)~.
>>
<<pre id="VALset_max_volatile_data_states_for_group_or_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_max~_volatile~_data~_states~_for~_group~_or~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile data sessions in the current session
    group ~(or for the client sub network~, if there is no group~)~.
>>
<<pre id="VALset_max_volatile_states_for_group_or_subnet" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_max~_volatile~_states~_for~_group~_or~_subnet>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> int <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the maximum number of volatile sessions
    ~(both data and service sessions~) in the current
    group ~(or for the client sub network~, if there is no group~)~.
>>


==@@id="2_Expirationofcookiesandtimeouts"@@~Expiration of cookies and timeouts==



===@@id="3_Cookieexpiration"@@~Cookie expiration===


~The functions in this section ask the browser to set the state cookie
    expiration date~, for the different kinds of session~, in seconds~,
    since the ~1st of ~January ~1~9~7~0~. <<span class="odocwiki_inlinecode"|~None>> means the cookie will expire
    when the browser is closed~. ~There is no way to set cookies
    for an infinite time on browsers~.
    ~By default~, ~Eliom sets default expiration date to
    ~1~0 years after opening the session~.


    ~By default~, it will affect regular browser cookies ~(sessions~)~.
    ~But if you set <<span class="odocwiki_inlinecode"|~~cookie~_level~:`~Client~_process>>~,
    it will only affect the client~-side ~Eliom process ~(if there is one~)~,
    which simulates some kind of "tab cookies"~.
<<pre id="VALset_service_cookie_exp_date" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_service~_cookie~_exp~_date>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >><<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the cookie expiration date for the current service state
    ~(see above~)~.
>>
<<pre id="VALset_volatile_data_cookie_exp_date" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_volatile~_data~_cookie~_exp~_date>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >><<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the cookie expiration date for the current data state ~(see
    above~)~.
>>
<<pre id="VALset_persistent_data_cookie_exp_date" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_persistent~_data~_cookie~_exp~_date>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >><<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Sets the cookie expiration date for the persistent state ~(see
    above~)~.
>>


===@@id="3_Globalconfigurationofstatetimeouts"@@~Global configuration of state timeouts===


~The following functions set the timeout for states~, for the
    different kinds of states~.  ~States will be closed after
    this amount of time of inactivity from the user~. <<span class="odocwiki_inlinecode"|~None>> means no
    timeout~.


    ~The optional parameter <<span class="odocwiki_inlinecode"|~?recompute~_expdates>> is <<span class="odocwiki_inlinecode"|false>> by
    default~.  ~If you set it to <<span class="odocwiki_inlinecode"|true>>~, the expiration dates for all
    states in the table will be recomputed with the new timeout~.
    ~That is~, the difference between the new timeout and the old one
    will be added to their expiration dates ~(asynchronously~,
    by another ~Lwt thread~, as this can take a long time~)~.
    ~States whose timeout has been set individually with
    functions like
    <<a_api subproject="server" | val Eliom_state.set_volatile_data_state_timeout >> won~'t be affected~.


    ~If <<span class="odocwiki_inlinecode"|~~scope~_hierarchy>> is not present~,
    it is the default for all scope hierarchies~,
    and in that case <<span class="odocwiki_inlinecode"|recompute~_expdates>> is ignored~. <<span class="odocwiki_inlinecode"|~~scope~_hierarchy~:~None>>
    means the default scope hierarchy~.


    ~If <<span class="odocwiki_inlinecode"|~~override~_configfile>> is <<span class="odocwiki_inlinecode"|true>> ~(default ~(<<span class="odocwiki_inlinecode"|false>>~)~,
    then the function will set the timeout even if it has been
    modified in the configuration file~.
    ~It means that by default~, these functions have no effect
    if there is a value in the configuration file~.
    ~This gives the ability to override the values chosen by the module
    in the configuration file~.
    ~Use <<span class="odocwiki_inlinecode"|~~override~_configfile~:true>> for example if your
    ~Eliom module wants to change the values afterwards
    ~(for example in the site configuration ~Web interface~)~.
<<pre id="VALset_global_volatile_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_global~_volatile~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?recompute_expdates: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the ~(server side~) timeout for volatile ~(~= "in memory"~) sessions ~(both
    service session and volatile data session~)~.
>>
<<pre id="VALset_global_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_global~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?recompute_expdates: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the ~(server side~) timeout for service states~.
>>
<<pre id="VALset_default_global_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_global~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_level: >>[< <<a_api subproject="server" text="Eliom_common.cookie_level" | type Eliom_common.cookie_level >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<pre id="VALset_global_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_global~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?recompute_expdates: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the ~(server side~) timeout for volatile ~(~= "in memory"~) data states~.
>>
<<pre id="VALset_default_global_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_global~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_level: >>[< <<a_api subproject="server" text="Eliom_common.cookie_level" | type Eliom_common.cookie_level >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<pre id="VALset_global_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_global~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?recompute_expdates: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|~Sets the ~(server side~) timeout for persistent states~.
>>
<<pre id="VALset_default_global_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_default~_global~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_level: >>[< <<a_api subproject="server" text="Eliom_common.cookie_level" | type Eliom_common.cookie_level >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?override_configfile: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<pre id="VALget_global_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_global~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option>>>><<div class="odocwiki_info"|~Returns the ~(server side~) timeout for service states~.
>>
<<pre id="VALget_global_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_global~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option>>>><<div class="odocwiki_info"|~Returns the ~(server side~) timeout for "volatile data" states~.
>>
<<pre id="VALget_global_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_global~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option>>>><<div class="odocwiki_info"|~Returns the ~(server side~) timeout for persistent states~.
>>


===@@id="3_Personalizingtimeoutsforcurrentstate"@@~Personalizing timeouts for current state===

<<pre id="VALset_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >><<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|sets the timeout for service state ~(server side~) for current user~,
   in seconds~. <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>
<<pre id="VALunset_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|remove the service state timeout for current user
   ~(and turn back to the default~)~.
>>
<<pre id="VALget_service_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_service~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option>>>><<div class="odocwiki_info"|returns the timeout for current service state~.
    <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>
<<pre id="VALset_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|sets the ~(server side~) timeout for volatile data state for current user~,
   in seconds~. <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>
<<pre id="VALunset_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit>>>><<div class="odocwiki_info"|remove the "volatile data" state timeout for current user
   ~(and turn back to the default~)~.
>>
<<pre id="VALget_volatile_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_volatile~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option>>>><<div class="odocwiki_info"|returns the timeout for current volatile data state~.
    <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>
<<pre id="VALset_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|sets the ~(server side~) timeout for persistent state for current user~,
   in seconds~. <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>
<<pre id="VALunset_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|unset~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|remove the persistent state timeout for current user
   ~(and turn back to the default~)~.
>>
<<pre id="VALget_persistent_data_state_timeout" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_persistent~_data~_state~_timeout>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| cookie_scope: >>[< <<a_api subproject="server" text="Eliom_common.cookie_scope" | type Eliom_common.cookie_scope >> ] <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> float option <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|returns the persistent state timeout for current user~.
    <<span class="odocwiki_inlinecode"|~None>> ~= no timeout
>>


==@@id="2_Administratingserversidestate"@@~Administrating server side state==


//~Warning~: ~Most these functions must be called when the site
    information is available~, that is~, either
    during a request or during the initialisation phase of the site~.
    ~Otherwise~, it will raise the exception
    <<a_api subproject="server" | exception Eliom_common.Eliom_site_information_not_available >>~.
    ~If you are using static linking~, you must delay the call to this function
    until the configuration file is read~, using
    <<a_api subproject="server" | val Eliom_service.register_eliom_module >>~. ~Otherwise you will also get
    this exception~.//
<<pre class="ocsforge_color odocwiki_code" id="TYPEvolatile_table"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_type"|'a>> <<span class="odocwiki_name"|volatile~_table>>>><<div class="odocwiki_info"|~The type of ~(volatile~) state data tables~.
>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEpersistent_table"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_type"|'a>> <<span class="odocwiki_name"|persistent~_table>>>><<div class="odocwiki_info"|~The type of persistent state data tables~.
>>
<<pre id="VALdiscard_everything" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_everything>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Discard all services and persistent and volatile data for every scopes~.
>>
<<pre id="VALdiscard_all" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_all>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Discard all services and persistent and volatile data for one scope~.
>>
<<pre id="VALdiscard_all_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_all~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?persistent: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Discard server side data for all clients~, for the given scope~.


    ~If the optional parameter <<span class="odocwiki_inlinecode"|~?persistent>> is not present~,
    both the persistent and volatile data will be removed~.
>>
<<pre id="VALdiscard_all_services" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|discard~_all~_services>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| scope: >><<a_api subproject="server" text="Eliom_common.user_scope" | type Eliom_common.user_scope >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?secure: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Remove all services registered for clients for the given scope~.
>>
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<a_api subproject="server" text="Ext" | module Eliom_state.Ext >> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api subproject="server" text=".." | module Eliom_state.Ext >><<span class="ocsforge_color_keyword"|end>>>>