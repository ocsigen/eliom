=Module <<a_api_type subproject="server" | module Eliom_common >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|Eliom_common>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api subproject="server" text=".." | module Eliom_common >><<span class="ocsforge_color_keyword"|end>>>>~Low level functions for ~Eliom~, exceptions and types~.

----
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<a_api subproject="server" text="Ocsipersist" | module Eliom_common.Ocsipersist >> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|module type of Ocsipersist>>>><<pre class="ocsforge_color odocwiki_code" id="TYPEscope_hierarchy"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|scope~_hierarchy>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Eliom_common_base>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|scope_hierarchy>>>> >><<div class="odocwiki_info"|
==@@id="2_Scopes"@@~Scopes==

>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEcookie_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|cookie~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|\\  [ `Client_process of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEuser_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|user~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|\\  [ `Client_process of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session_group of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEscope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|\\  [ `Client_process of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session_group of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Site ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEall_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|all~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|\\  [ `Client_process of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Global\\  | `Request\\  | `Session of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Session_group of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>\\  | `Site ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEcookie_level"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|cookie~_level>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Client_process | `Session ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEuser_level"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|user~_level>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Client_process | `Session | `Session_group ]>> >><<pre id="VALcookie_scope_of_user_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|cookie~_scope~_of~_user~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[< <<a_api subproject="server" text="user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> [> <<a_api subproject="server" text="cookie_scope" | type Eliom_common.cookie_scope >> ]>>>><<pre id="VALcookie_level_of_user_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|cookie~_level~_of~_user~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[< <<a_api subproject="server" text="user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> [> <<a_api subproject="server" text="cookie_level" | type Eliom_common.cookie_level >> ]>>>><<pre id="VALlevel_of_user_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|level~_of~_user~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[< <<a_api subproject="server" text="user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> [> <<a_api subproject="server" text="user_level" | type Eliom_common.user_level >> ]>>>><<pre id="VALscope_hierarchy_of_user_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|scope~_hierarchy~_of~_user~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[< <<a_api subproject="server" text="user_scope" | type Eliom_common.user_scope >> ] <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>>>>>
~Eliom is using regular ~(browser~) cookies but can also use its own
    browser tab cookies ~(only if you are using a client side ~Eliom application~)~.


    ~It is possible to define ~Eliom references or services for one
    ~(browser~) session~, for one tab~, or for one group of sessions~.


    ~Using <<span class="odocwiki_inlinecode"|`~Global>> scope means you want the data or service to
    be available to any client~. <<span class="odocwiki_inlinecode"|`~Site>> is limited to current sub~-site
    ~(if you have several sites on the same server~)~.


    ~If you want to restrict the visibility of an ~Eliom reference or
    a service~:
    ~* to a browser session~, use <<span class="odocwiki_inlinecode"|~~scope~:~Eliom~_common~.default~_session~_scope>>~,
    ~* to a group of sessions~, use <<span class="odocwiki_inlinecode"|~~scope~:~Eliom~_common~.default~_group~_scope>>~,
    ~* to a client process~, use <<span class="odocwiki_inlinecode"|~~scope~:~Eliom~_common~.default~_process~_scope>>~.
    ~If you have a client side ~Eliom program running~, and you want to restrict
    the visibility of the service to this instance of the program~,
    use <<span class="odocwiki_inlinecode"|~~scope~:~Eliom~_common~.default~_process~_scope>>~.


    ~You can create new scope
    hierarchies with <<a_api subproject="server" | val Eliom_common.create_scope_hierarchy >>~.
    ~Thus it is possible to have for example several sessions that can
    be opened or closed independently~. ~They use different cookies~.


    ~Secure scopes are associated to secure cookies ~(that is~, cookies sent
    by browsers only if the protocol is https~)~.
<<pre class="ocsforge_color odocwiki_code" id="TYPEglobal_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|global~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Global ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEsite_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|site~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Site ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEsession_group_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|session~_group~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Session_group of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEsession_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|session~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Session of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPEclient_process_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|client~_process~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Client_process of <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> ]>> >><<pre class="ocsforge_color odocwiki_code" id="TYPErequest_scope"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|request~_scope>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_type"|[ `Request ]>> >><<pre id="VALglobal_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|global~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="global_scope" | type Eliom_common.global_scope >> ]>>>><<pre id="VALsite_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|site~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="site_scope" | type Eliom_common.site_scope >> ]>>>><<pre id="VALdefault_group_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|default~_group~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="session_group_scope" | type Eliom_common.session_group_scope >> ]>>>><<pre id="VALdefault_session_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|default~_session~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="session_scope" | type Eliom_common.session_scope >> ]>>>><<pre id="VALdefault_process_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|default~_process~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="client_process_scope" | type Eliom_common.client_process_scope >> ]>>>><<pre id="VALcomet_client_process_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|comet~_client~_process~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="client_process_scope" | type Eliom_common.client_process_scope >> ]>>>><<pre id="VALrequest_scope" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|request~_scope>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[> <<a_api subproject="server" text="request_scope" | type Eliom_common.request_scope >> ]>>>><<pre id="VALcreate_scope_hierarchy" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|create~_scope~_hierarchy>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >>>>>><<pre id="VALlist_scope_hierarchies" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|list~_scope~_hierarchies>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api subproject="server" text="scope_hierarchy" | type Eliom_common.scope_hierarchy >> list>>>>

==@@id="2_Exceptionanderrorhandling"@@~Exception and error handling==

<<pre id="EXCEPTIONEliom_404" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Eliom_404>>>><<div class="odocwiki_info"|~Page not found
>>
<<pre id="EXCEPTIONEliom_Wrong_parameter" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Eliom_Wrong_parameter>>>><<div class="odocwiki_info"|~Service called with wrong parameter names
>>
<<pre id="EXCEPTIONEliom_Session_expired" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Eliom_Session_expired>>>><<pre id="EXCEPTIONEliom_Typing_Error" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Eliom_Typing_Error>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<span class="ocsforge_color_delimiter"| ( >>string * exn<<span class="ocsforge_color_delimiter"| ) >> list>>>><<div class="odocwiki_info"|~The service ~(~G~E~T or ~P~O~S~T~) parameters do not match expected type
>>
<<pre id="EXCEPTIONEliom_site_information_not_available" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Eliom_site_information_not_available>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|string>>>><<div class="odocwiki_info"|~That function cannot be used when the site information is not available~,
    that is~, outside a request or the initialisation phase of your ~Eliom module
    ~(while reading the configuration file~)~.


    ~In particular~, you cannot use the function before the configuration file
    is read for example when you are using //static linking//~.
    ~In that case you must
    delay the function call using <<a_api subproject="server" | val Eliom_service.register_eliom_module >>~.
>>
<<pre id="EXCEPTIONCannot_call_this_function_before_app_is_linked_to_a_site" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|Cannot_call_this_function_before_app_is_linked_to_a_site>>>><<div class="odocwiki_info"|~Statically linked app~: ~You cannot call this function before <<span class="odocwiki_inlinecode"|~Eliom~_run>>~.
>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEfull_state_name"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|full~_state~_name>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="ocsforge_color_delimiter"|~{>>
<<span class="odocwiki_record"|<<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|user_scope:>> <<span class="odocwiki_type"|<<a_api subproject="server" text="user_scope" | type Eliom_common.user_scope >>>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|secure:>> <<span class="odocwiki_type"|bool>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|site_dir_str:>> <<span class="odocwiki_type"|string>><<span class="ocsforge_color_delimiter"|~;>> >>>>>><<span class="ocsforge_color_delimiter"|~}>>>><<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<a_api subproject="server" text="Full_state_name_table" | module Eliom_common.Full_state_name_table >> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Map.S>>>><<span class="odocwiki_type"|  with type key = full_state_name>>>><<pre id="VALeliom_link_too_old" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|eliom~_link~_too~_old>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|bool <<span class="ocsforge_color_uid"|Polytables>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|key>>>>>><<div class="odocwiki_info"|~If present and true in request data~, it means that
    the previous coservice does not exist any more
>>
<<pre id="VALeliom_service_session_expired" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|eliom~_service~_session~_expired>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_delimiter"| ( >><<a_api subproject="server" text="full_state_name" | type Eliom_common.full_state_name >> list * <<a_api subproject="server" text="full_state_name" | type Eliom_common.full_state_name >> list<<span class="ocsforge_color_delimiter"| ) >>\\  <<span class="ocsforge_color_uid"|Polytables>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|key>>>>>><<div class="odocwiki_info"|~If present in request data~, means that
    the service session cookies does not exist any more~.
    ~The string lists are the list of names of expired sessions
>>
