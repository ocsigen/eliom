<html><head><title>Generating HTML pages &amp;#182;</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="text/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="clientserver-html eliom"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Eliom</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p class="mainmenu-current"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1> Eliom's Reference manual</h1><h2><a href="intro" class="ocsimore_phrasing_link">Introduction</a></h2><h3><span><a href=".././../../tuto/latest/manual/basics">Client-server applications</a></span></h3><h3><span><a href=".././../../tuto/latest/manual/basics-server">Server-side websites</a></span></h3><h2>Server-side programming</h2><h3>Services</h3><h4><a href="server-services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="server-params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="server-outputs" class="ocsimore_phrasing_link">Service handlers</a></h4><h4><a href="server-links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="server-state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="server-security" class="ocsimore_phrasing_link">Security</a></h3><h2>Client-server programming</h2><h3><a href="clientserver-applications" class="ocsimore_phrasing_link">Eliom applications</a></h3><h3><a href="ppx-syntax" class="ocsimore_phrasing_link">Multi-tier programming</a></h3><h3><a href="clientserver-html" class="ocsimore_phrasing_link">Generating HTML</a></h3><h3><a href="clientserver-communication" class="ocsimore_phrasing_link">Communication</a></h3><h3><a href="clientserver-services" class="ocsimore_phrasing_link">Client-side services</a></h3><h3><a href="clientserver-react" class="ocsimore_phrasing_link">Shared reactive programming</a></h3><h3><a href="clientserver-cache" class="ocsimore_phrasing_link">Caching data and off-line applications</a></h3><h3><a href="clientserver-wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h2>Workflows</h2><h3><a href="workflow-distillery" class="ocsimore_phrasing_link">Distillery</a></h3><h3><a href="mobile-apps" class="ocsimore_phrasing_link">Mobile apps</a></h3><h3><a href="workflow-configuration" class="ocsimore_phrasing_link">Configuration &amp; running</a></h3><h3><a href="scalability" class="ocsimore_phrasing_link">Scalability</a></h3><h1>Ocamlbuild plugin</h1><h2><a href=".././api/ocamlbuild/Ocamlbuild_eliom" class="ocsimore_phrasing_link">Ocamlbuild_eliom</a></h2><h1>Server API</h1><h2><a href=".././api/server/Eliom_lib" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href=".././api/server/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href=".././api/server/Eliom_client_value" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2><a href=".././api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href=".././api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href=".././api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2><a href=".././api/server/Eliom_reference" class="ocsimore_phrasing_link">Eliom_reference</a></h2><h2><a href=".././api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h2><h2>Content and form creation</h2><h3><a href=".././api/server/Eliom_content" class="ocsimore_phrasing_link">Eliom_content</a></h3><h3><a href=".././api/server/Eliom_content.Html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href=".././api/server/Eliom_content.Svg" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href=".././api/server/Eliom_content.Xml" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h3><a href=".././api/server/Eliom_tools" class="ocsimore_phrasing_link">Eliom_tools</a></h3><h2>Service creation</h2><h3><a href=".././api/server/Eliom_service" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href=".././api/server/Eliom_parameter" class="ocsimore_phrasing_link">Eliom_parameter</a></h3><h3><a href=".././api/server/Eliom_registration" class="ocsimore_phrasing_link">Eliom_registration</a></h3><h3><a href=".././api/server/Eliom_registration.Html" class="ocsimore_phrasing_link">Eliom_registration.Html</a></h3><h3><a href=".././api/server/Eliom_registration.Action" class="ocsimore_phrasing_link">Eliom_registration.Action</a></h3><h3><a href=".././api/server/Eliom_registration.Ocaml" class="ocsimore_phrasing_link">Eliom_registration.Ocaml</a></h3><h3><a href=".././api/server/Eliom_registration.App" class="ocsimore_phrasing_link">Eliom_registration.App</a></h3><h3><a href=".././api/server/Eliom_registration.File" class="ocsimore_phrasing_link">Eliom_registration.File</a></h3><h3><a href=".././api/server/Eliom_registration.Any" class="ocsimore_phrasing_link">Eliom_registration.Any</a></h3><h3><a href=".././api/server/Eliom_registration.Redirection" class="ocsimore_phrasing_link">Eliom_registration.Redirection</a></h3><h2>Client/server communication</h2><h3><a href=".././api/server/Eliom_shared" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href=".././api/server/Eliom_notif" class="ocsimore_phrasing_link">Eliom_notif</a></h3><h3><a href=".././api/server/Eliom_cscache" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href=".././api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href=".././api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href=".././api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a href=".././api/server/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/server/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/server/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/server/index_module_types">Index of module types</a></span></h3><h1>Client API</h1><h2><a href=".././api/client/Eliom_lib" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href=".././api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href=".././api/client/Eliom_client_value" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2>Content and form creation</h2><h3><a href=".././api/client/Eliom_content.Html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href=".././api/client/Eliom_content.Svg" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href=".././api/client/Eliom_content.Xml" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h2>Client/server communication</h2><h3><a href=".././api/client/Eliom_service" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href=".././api/client/Eliom_shared" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href=".././api/client/Eliom_cscache" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href=".././api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href=".././api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href=".././api/client/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a href=".././api/client/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/client/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/client/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/client/index_module_types">Index of module types</a></span></h3><h1>Ppx syntax</h1><h2><a href=".././api/ppx/Ppx_eliom" class="ocsimore_phrasing_link">Ppx_eliom</a></h2></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/clientserver-html" selected="selected">dev</option><option value=".././../10.x/manual/clientserver-html">10.x</option><option value=".././../8.x/manual/clientserver-html">8.x</option><option value=".././../1.3.4/manual/clientserver-html">1.3.4</option></select><nav class="how-doctree"><h1> Eliom's Reference manual</h1><h2><a href="intro" class="ocsimore_phrasing_link">Introduction</a></h2><h3><span><a href=".././../../tuto/latest/manual/basics">Client-server applications</a></span></h3><h3><span><a href=".././../../tuto/latest/manual/basics-server">Server-side websites</a></span></h3><h2>Server-side programming</h2><h3>Services</h3><h4><a href="server-services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="server-params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="server-outputs" class="ocsimore_phrasing_link">Service handlers</a></h4><h4><a href="server-links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="server-state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="server-security" class="ocsimore_phrasing_link">Security</a></h3><h2>Client-server programming</h2><h3><a href="clientserver-applications" class="ocsimore_phrasing_link">Eliom applications</a></h3><h3><a href="ppx-syntax" class="ocsimore_phrasing_link">Multi-tier programming</a></h3><h3><a href="clientserver-html" class="ocsimore_phrasing_link">Generating HTML</a></h3><h3><a href="clientserver-communication" class="ocsimore_phrasing_link">Communication</a></h3><h3><a href="clientserver-services" class="ocsimore_phrasing_link">Client-side services</a></h3><h3><a href="clientserver-react" class="ocsimore_phrasing_link">Shared reactive programming</a></h3><h3><a href="clientserver-cache" class="ocsimore_phrasing_link">Caching data and off-line applications</a></h3><h3><a href="clientserver-wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h2>Workflows</h2><h3><a href="workflow-distillery" class="ocsimore_phrasing_link">Distillery</a></h3><h3><a href="mobile-apps" class="ocsimore_phrasing_link">Mobile apps</a></h3><h3><a href="workflow-configuration" class="ocsimore_phrasing_link">Configuration &amp; running</a></h3><h3><a href="scalability" class="ocsimore_phrasing_link">Scalability</a></h3><h1>Ocamlbuild plugin</h1><h2><a href=".././api/ocamlbuild/Ocamlbuild_eliom" class="ocsimore_phrasing_link">Ocamlbuild_eliom</a></h2><h1>Server API</h1><h2><a href=".././api/server/Eliom_lib" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href=".././api/server/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href=".././api/server/Eliom_client_value" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2><a href=".././api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href=".././api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href=".././api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2><a href=".././api/server/Eliom_reference" class="ocsimore_phrasing_link">Eliom_reference</a></h2><h2><a href=".././api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h2><h2>Content and form creation</h2><h3><a href=".././api/server/Eliom_content" class="ocsimore_phrasing_link">Eliom_content</a></h3><h3><a href=".././api/server/Eliom_content.Html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href=".././api/server/Eliom_content.Svg" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href=".././api/server/Eliom_content.Xml" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h3><a href=".././api/server/Eliom_tools" class="ocsimore_phrasing_link">Eliom_tools</a></h3><h2>Service creation</h2><h3><a href=".././api/server/Eliom_service" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href=".././api/server/Eliom_parameter" class="ocsimore_phrasing_link">Eliom_parameter</a></h3><h3><a href=".././api/server/Eliom_registration" class="ocsimore_phrasing_link">Eliom_registration</a></h3><h3><a href=".././api/server/Eliom_registration.Html" class="ocsimore_phrasing_link">Eliom_registration.Html</a></h3><h3><a href=".././api/server/Eliom_registration.Action" class="ocsimore_phrasing_link">Eliom_registration.Action</a></h3><h3><a href=".././api/server/Eliom_registration.Ocaml" class="ocsimore_phrasing_link">Eliom_registration.Ocaml</a></h3><h3><a href=".././api/server/Eliom_registration.App" class="ocsimore_phrasing_link">Eliom_registration.App</a></h3><h3><a href=".././api/server/Eliom_registration.File" class="ocsimore_phrasing_link">Eliom_registration.File</a></h3><h3><a href=".././api/server/Eliom_registration.Any" class="ocsimore_phrasing_link">Eliom_registration.Any</a></h3><h3><a href=".././api/server/Eliom_registration.Redirection" class="ocsimore_phrasing_link">Eliom_registration.Redirection</a></h3><h2>Client/server communication</h2><h3><a href=".././api/server/Eliom_shared" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href=".././api/server/Eliom_notif" class="ocsimore_phrasing_link">Eliom_notif</a></h3><h3><a href=".././api/server/Eliom_cscache" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href=".././api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href=".././api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href=".././api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a href=".././api/server/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/server/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/server/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/server/index_module_types">Index of module types</a></span></h3><h1>Client API</h1><h2><a href=".././api/client/Eliom_lib" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href=".././api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href=".././api/client/Eliom_client_value" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2>Content and form creation</h2><h3><a href=".././api/client/Eliom_content.Html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href=".././api/client/Eliom_content.Svg" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href=".././api/client/Eliom_content.Xml" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h2>Client/server communication</h2><h3><a href=".././api/client/Eliom_service" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href=".././api/client/Eliom_shared" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href=".././api/client/Eliom_cscache" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href=".././api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href=".././api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href=".././api/client/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a href=".././api/client/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/client/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/client/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/client/index_module_types">Index of module types</a></span></h3><h1>Ppx syntax</h1><h2><a href=".././api/ppx/Ppx_eliom" class="ocsimore_phrasing_link">Ppx_eliom</a></h2></nav></nav><article class="rightcol"><h1 id="server_generating_html">Generating HTML pages <a class="backref" href="#server_generating_html">&#182;</a></h1><p>Ocsigen provides several ways to generate and type HTML pages.
</p><ul><li> The default technique to produce HTML pages using Eliom are the
<span><a href=".././api/server/Eliom_content.Html.F">Eliom_content.Html.F</a></span>,
<span><a href=".././api/server/Eliom_content.Html.D">Eliom_content.Html.D</a></span> and
<span><a href=".././api/server/Eliom_content.Html.R">Eliom_content.Html.R</a></span>
modules. It is the only one supported for client-server Eliom programs.
This module provides a typing based on OCaml's polymorphic variants,
which ensures at compile time, that the pages you will generate will
respect the recommendations of the W3C (or be very close).
</li><li> It is also possible to use a syntax extension to write your pages with the
usual HTML syntax. This solution is also typed with polymorphic variants
and is compatible with the previous one.
</li><li> You can also choose to generate untyped html as text.
</li></ul><p>The types in OCaml closest to XML types are <em>polymorphic variants</em>.
Ocsigen uses them to provide a module with very good HTML typing.
The full documentation is available
<span><a href=".././../../tyxml/latest/api/Tyxml.Html">in the TyXML documentation</a></span>.
</p><div id="overview" class="ocsimore_outline"><header><p><strong>Table of contents</strong></p></header></div><script>
//<![CDATA[
window.addEventListener("load", function(){ outline([0,-515484383,0,[0,2],[0,"nav",[0,"aside",0]],"overview",1]); }, false); 
//]]>
</script><h2> Generating HTML for Eliom applications</h2><h3> The TyXML library vs. the DOM API</h3><p>On client side there are two kinds of HTML representations: one is
based on the <span><a href=".././../../tyxml/index.html">TyXML library</a></span> and the other
one is the browser DOM tree accessible through Js_of_ocaml modules
<span><a href=".././../../js_of_ocaml/latest/api/js_of_ocaml/Js_of_ocaml/Dom/#module-Dom">Js_of_ocaml.Dom</a></span> and <span><a href=".././../../js_of_ocaml/latest/api/js_of_ocaml/Js_of_ocaml/Dom_html/#module-Dom_html">Js_of_ocaml.Dom_html</a></span>. The TyXML representation is
a OCaml immutable typed tree. The DOM tree is mutable structure
manipulated using the browser API which permit the modification of the
displayed page. In the DOM represention adding a node as a child to an
other node removes it from its previous ancessor.
</p><p>Since those representation does not behave at all the same way, they
are not used for the same thing.
</p><ul><li> It is far easier and safer to describe content using TyXML, but it
is not possible to add a TyXML element to the page without explicit
conversion to the DOM representation.
</li></ul><ul><li> The TyXML representation has the same interface on client and server
side. This allows share code between server and client.
</li></ul><ul><li> Dom manipulation is heavy: to build some part of a tree, one needs
to create each node separately then append them to their parents.
</li></ul><p>For example, here is a <span class="teletype">div</span> element built with TyXML and then
converted to the DOM representation using the module </p><dl><dd>
</dd></dl><pre class="client" class=""><code class="language-ocaml translatable">open%client Eliom_content.Html.D
let%client n = div ~a:[a_id &quot;some div id&quot;]
  [ txt &quot;some text&quot;;
    br ();
    txt &quot;some other text&quot;; ]
let%client b = Eliom_content.Html.To_dom.of_div n</code></pre><p>And here the same built using the DOM API:
</p><pre class="client" class=""><code class="language-ocaml translatable">open%client Dom
open%client Dom_html

let%client d =
  let d = createDiv document in
  let t1 = document##createTextNode(Js.string &quot;some text&quot;) in
  let t2 = document##createTextNode(Js.string &quot;some other text&quot;) in
  let b = createB document in
  appendChild d t1;
  appendChild d b;
  appendChild d t2;
  d##.id := (Js.string &quot;some div id&quot;);
  d</code></pre><p>To ease the DOM manipulation on the client, the usual DOM manipulation
function are also available on TyXML elements. See section the next
section for HTML element manipulation, by value and by reference.
</p><h3 id="unique"> HTML element manipulation, by value and by reference <a class="backref" href="#unique">&#182;</a></h3><p>There are four modules to create typed HTML:
<span><a href=".././api/server/Eliom_content.Html.F">Eliom_content.Html.F</a></span>,
<span><a href=".././api/server/Eliom_content.Html.D">Eliom_content.Html.D</a></span>,
<span><a href=".././api/server/Eliom_content.Html.C">Eliom_content.Html.C</a></span> and
<span><a href=".././api/server/Eliom_content.Html.R">Eliom_content.Html.R</a></span>.
The last one is for reactive elements and is addressed in
<span><a href=".././manual/clientserver-html"> another section </a></span>.
</p><p>It is possible to mix the four kinds of nodes in the same page.
</p><p>Elements built with <span class="teletype">Html.F</span> are sent by value, while
elements built with <span class="teletype">Html.D</span> are sent to the client by
reference. Eliom adds an identifier as attribute of <span class="teletype">D</span> elements
to make it possible to find them back in the page from client side.
</p><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>In short: D or F?</h5></header><ul><li> If your program is server-side only (Web site) or client-side only,
use module <span class="teletype">F</span>.
</li><li> If you are writing a client-server Eliom program,
module <span class="teletype">D</span> will probably do what you expect most of the times.
We recommend this as the default for beginners.
But it will add identifiers attributes to each node.
</li><li> If you want to avoid these identifiers when not needed,
use module <span class="teletype">D</span> only when the node is used in an injection (<span class="teletype">~%n</span>),
and module <span class="teletype">F</span> otherwise.</li></ul></aside><p>Sending elements by reference allows easy manipulation of elements
included in the initial html document from event handlers, as the
<span class="teletype">input</span> element in the following example.
</p><pre class="server" class=""><code class="language-ocaml translatable">let%server main_service =
  My_app.register_service
    ~path:(Eliom_service.Path [&quot;&quot;])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    (fun () () -&gt;
       let open Eliom_content.Html.D in
       let input = input ~a:[a_input_type `Text] () in
       let onclick_handler = [%client (fun _ -&gt;
            let v =
              Js.to_string
                (Eliom_content.Html.To_dom.of_input ~%input)##.value
            in
            Dom_html.window##alert(Js.string (&quot;Input value :&quot; ^ v)))
       ] in
       let button =
         button ~a:[a_onclick onclick_handler] [txt &quot;Read value&quot;]
       in
       Lwt.return
         (html
            (head (title (txt &quot;Test&quot;)) [])
            (body [input; button])))</code></pre><p>In this example, if the input button would have been incorrectly sent
by value, two different input fields would have been created: one
displayed in the document and one referenced from the event
handler. The latter will always contains an empty value.
</p><p>There are still two situations where sending elements by value is still
required:
</p><ul><li> one want to have multiple occurences of the same elements in the
document. Indeed, elements sent by reference follow the DOM
semantics where an element have only one instance in current
document. For example, the following list will contains a single
element:<br/> <br/> <span class="teletype">let li = li [txt &quot;Shared item&quot;] in ul [li; li; li;] </span>.
</li></ul><ul><li> one have a large page with a lot elements. Handling elements by
references add a small overhead while loading the page, around 50ms
per 1000 elements on a not so fast computer.
</li></ul><p>In any case, it is possible to mix elements sent by references and
elements sent by value in the same document.
</p><p>By default, a reference on an element is only valid in the current
HTTP request: hence, sending an element built with
<span class="teletype">Html.D</span> in
two different pages will produce two distinct nodes. If you want to
define a element reference that is preserved accross the different
page of an application, you must explicitely name this element with
the function <span><a href=".././api/server/Eliom_content.Html.Id#VALcreate_named_elt">Eliom_content.Html.Id.create_named_elt</a></span>, that takes as parameters an
element identifier and a non named element.  Element identifiers are
created with the function <span><a href=".././api/server/Eliom_content.Html.Id#VALnew_elt_id">Eliom_content.Html.Id.new_elt_id</a></span>. See also section <span><a href=".././manual/clientserver-applications#global">Global elements of an
application</a></span>.
</p><p>The module <span><a href=".././api/client/Eliom_content.Html.Manip">Eliom_content.Html.Manip</a></span>
allows using the classical DOM manipulation functions
(e.g. appendChild, addEventlistener, ...) directly on the identifier
of an HTML elements.
</p><h3 id="reactive">Reactive DOM <a class="backref" href="#reactive">&#182;</a></h3><p><span class="teletype">Eliom_content.Html.R</span> allows one to insert time-varying values
into the DOM tree.
It relies on React's signal <span class="teletype">'a React.signal</span>. More information about react
can be found on the <a href="http://erratique.ch/software/react" class="ocsimore_phrasing_link"> homepage</a>.
The react nodes also use <a href="https://github.com/ocsigen/reactiveData" class="ocsimore_phrasing_link">ReactiveData</a>,
which allows to manipulate lists of nodes in a reactive way.
</p><p>When dealing with dynamic content, one usally ends up with a lot
of imperative DOM manipulations: replacing, appending, removing DOM
elements, updating attributes, etc. <span class="teletype">Html.R</span> hides most
of those imperative DOM operations. Every time a signal
changes, the corresponding DOM tree updates itself.
</p><h4> Usage on client side</h4><p>To insert reactive DOM elements, just use module <span class="teletype">Html.R</span> instead of
<span class="teletype">Html.D</span> or <span class="teletype">Html.F</span> for these elements.
<span class="teletype">Html.R</span> makes also possible to define reactive attributes.
</p><p>Use function <span class="teletype">Html.R.node : 'a elt React.signal -&gt; 'a elt</span>
to insert a reactive node in a page.
</p><h5> Example</h5><pre class="shared" class=""><code class="language-ocaml translatable">open%shared Eliom_lib
open%shared Eliom_content
open%shared Html
open%shared F</code></pre><pre class="server" class=""><code class="language-ocaml translatable">module%server Reactivenodes_app =
  Eliom_registration.App (
  struct
    let application_name = &quot;reactivenodes&quot;
    let global_data_path = None
  end)</code></pre><pre class="client" class=""><code class="language-ocaml translatable">open%client Eliom_content.Html

let%client split s =
      let len = String.length s in
      let rec aux acc = function
        | 0 -&gt; acc
        | n -&gt; aux (s.[n - 1] :: acc) (pred n)
      in aux [] len

let%client value_signal, set_value = React.S.create &quot;initial&quot;

let%client value_len = React.S.map String.length value_signal

let%client content_signal : Html_types.div_content_fun elt React.signal =
      React.S.map
        (fun value -&gt;
           let l = split value in
           F.div (
             List.map (fun c -&gt; F.p [F.txt (Printf.sprintf &quot;%c&quot; c)]) l
           ))
        value_signal

let%client make_color len =
      let d = (len * 10) mod 255 in
      Printf.sprintf &quot;color: rgb(%d,%d,%d)&quot; d d d

let%client make_client_nodes () =
      [
        D.p [R.txt value_signal];
        D.p ~a:[ R.a_style (React.S.map make_color value_len)]
          [R.txt value_signal];
        R.node content_signal
      ]</code></pre><pre class="server" class=""><code class="language-ocaml translatable">let%server make_input () =
  let inp = D.Raw.input ~a:[a_input_type `Text] () in
  let _ = [%client
    (Lwt_js_events.(async (fun () -&gt;
       let inp = To_dom.of_input ~%inp in
       keyups inp (fun _ _ -&gt;
         let s = Js.to_string (inp##.value) in
         set_value s;
         Lwt.return ())))
     : unit)
  ] in
  inp

let%server main_service =
  Eliom_service.create
    ~path:(Eliom_service.Path [])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    ()

let%server () =
  Reactivenodes_app.register
    ~service:main_service
    (fun () () -&gt;
       let inp = make_input () in
       let cldiv = C.node [%client D.div (make_client_nodes ())] in
       Lwt.return
         (Eliom_tools.F.html
            ~title:&quot;reactivenodes&quot;
            ~css:[[&quot;css&quot;; &quot;reactivenodes.css&quot;]]
            (body [F.h1 [txt &quot;Reactive DOM&quot;];
                   inp;
                   F.h2 [txt &quot;Client side reactive nodes:&quot;];
                   cldiv;
                  ])
         ))</code></pre><h3 id="inject">Dom &amp; Client-values <a class="backref" href="#inject">&#182;</a></h3><p><span class="teletype">Eliom_content.Html.C</span> allows one to insert client-side content
into server-side HTML-trees. This makes possible, for example, to insert
reactive nodes in a server-side generated page.
</p><h4> Example</h4><pre class="shared" class=""><code class="language-ocaml translatable">open%shared Eliom_lib
open%shared Eliom_content
open%shared Html
open%shared F</code></pre><pre class="server" class=""><code class="language-ocaml translatable">module%server Testnodes_app =
  Eliom_registration.App (
  struct
    let application_name = &quot;testnodes&quot;
    let global_data_path = None
  end)

let%server main_service =
  Eliom_service.create
    ~path:(Eliom_service.Path [])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    ()</code></pre><pre class="client" class=""><code class="language-ocaml translatable">open%client Eliom_content.Html
let%client
  (value_signal : string React.signal), set_value = React.S.create &quot;initial&quot;</code></pre><pre class="server" class=""><code class="language-ocaml translatable">let%server client_reactive_attrib () = [%client
  R.a_style value_signal
]

let%server client_reactive_title () = [%client
  F.h1 [txt &quot;I'm a client node&quot;]
]

let%server () =
  Testnodes_app.register
    ~service:main_service
    (fun () () -&gt;
       Lwt.return
         (Eliom_tools.F.html
            ~title:&quot;testnodes&quot;
            ~css:[[&quot;css&quot;; &quot;testnodes.css&quot;]]
            (body [
               F.div ~a:[C.attr (client_reactive_attrib ())] [
                 C.node (client_reactive_title ())
               ]
             ])))</code></pre><p>Module C is also available on client-side, to make it possible to use it
in shared sections.
</p><h3 id="global">Global elements of an application <a class="backref" href="#global">&#182;</a></h3><p>Sometimes you may want to modify the content of an HTML element and to
keep the element and its modified content when changing page. For
example a <span class="teletype">div</span> element which contains a chat box or a music
player should be preserved while browsing across the different pages of
your site. For this purpose, Eliom provides a notion of global element. Such
elements are instantied only once for an application and that unique
instance is used in every page that references the element.
</p><p>To create a global element, use function <span><a href=".././api/client/Eliom_content.Html.Id#VALcreate_global_elt">Eliom_content.Html.Id.create_global_elt</a></span>.
</p><pre class=""><code class="language-ocaml translatable">val create_global_elt: 'a elt -&gt; 'a elt</code></pre><p>In the following example, the content of <span class="teletype">global_list</span> will be
preserved when you click on the &quot;reload page&quot; link.
</p><pre class="shared" class=""><code class="language-ocaml translatable">open%shared Eliom_content.Html.D</code></pre><pre class="server" class=""><code class="language-ocaml translatable">module%server My_app =
  Eliom_registration.App (
  struct
    let application_name = &quot;myo&quot;
    let global_data_path = None
  end)

let%server global_list = Eliom_content.Html.Id.create_global_elt (ul [])
let%server cpt = ref 0

let%server main_service =
  Eliom_service.create
    ~path:(Eliom_service.Path [&quot;&quot;])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    ()

let%server reload_link =
  a ~service:main_service [txt &quot;reload page&quot;] ()

let%server _ =
  My_app.register ~service:main_service
    (fun () () -&gt;
       let page_number = incr cpt; string_of_int !cpt in
       let append_item = [%client
	 let item_text = &quot;item inserted in page #&quot; ^ ~%page_number in
         let item = Eliom_client.Html.of_li (li [txt item_text]) in
         Dom.appendChild (Eliom_client.Html.of_ul ~%global_list) item
       ]
       in
       let append_link =
         a ~a:[a_onclick append_item] [txt &quot;append item&quot;]
       in
       Lwt.return
         (html
	    (head (title (txt &quot;Test&quot;)) [])
            (body [h1 [txt (&quot;Page #&quot; ^ page_number)];
	           p [append_link];
		   p [reload_link];
		   global_list]) ) )</code></pre><p>Another use of global element is for external javascript that should
be included in every page but must be executed only once in an
application. In the following code snippet, the alert &quot;global script&quot;
is displayed only once, while the alert &quot;non global script&quot; is display
every time you click on the &quot;reload page&quot; link.
</p><pre class="server" class=""><code class="language-ocaml translatable">open%server Eliom_content.Html.D

let%server global_script =
  Eliom_content.Html.Id.create_global_elt
    (script (cdata_script &quot;alert(\&quot;global script\&quot;)&quot;))
let%server simple_script =
  script (cdata_script &quot;alert(\&quot;non global script\&quot;)&quot;)

let%server main_service =
  Eliom_service.create
    ~path:(Eliom_service.Path [])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    ()

let%server reload_link =
  a ~service:main_service [txt &quot;reload page&quot;] ()

let%server _ =
  My_app.register ~service:main_service
    (fun () () -&gt;
       Lwt.return
         (html
            (head
               (title (txt &quot;Global script example&quot;))
               [global_script; simple_script])
            (body [p [reload_link]])))</code></pre><h3> HTML syntax extension</h3><p>It is possible to use regular HTML syntax using Tyxml's PPX syntax extension.
</p><p>See <span><a href=".././../../tyxml/latest/manual/ppx">Tyxml's manual</a></span>.
</p><h3 id="text_html">Text HTML <a class="backref" href="#text_html">&#182;</a></h3><p>The last possibility is to use untyped HTML. Just build strings
containing your pages. Here is an example:
</p><pre class="server" class=""><code class="language-ocaml translatable">let%server hello =
  Eliom_registration.Html_text.create
    ~path:(Eliom_service.Path [&quot;hello&quot;])
    ~meth:(Eliom_service.Get Eliom_parameter.unit)
    (fun () () -&gt; Lwt.return &quot;&lt;html&gt;Hello&lt;/html&gt;&quot;)</code></pre><p>Writing HTML as text makes applications much more difficult to maintain.
We do not recommend this.
</p><h3 id="custom_data">Custom data for HTML <a class="backref" href="#custom_data">&#182;</a></h3><p>Eliom provides a type-safe interface for create new attributes of the form <span class="teletype">data-*</span>, using  <span><a href=".././api/server/Eliom_content.Html.Custom_data">Eliom_content.Html.Custom_data</a></span>.
</p><h4> Creation </h4><p>Custom data may be created either from string-conversation functions by <span><a href=".././api/server/Eliom_content.Html.Custom_data#VALcreate">Eliom_content.Html.Custom_data.create</a></span>
</p><pre class="server" class=""><code class="language-ocaml translatable">open%server Eliom_content
let%server my_int_data =
  Html.Custom_data.create ~name:&quot;my_int&quot;
    ~of_string:int_of_string
    ~to_string:string_of_int ()</code></pre><p>or by a Json-deriving type <span><a href=".././api/server/Eliom_content.Html.Custom_data#VALcreate_json">Eliom_content.Html.Custom_data.create_json</a></span>
</p><pre class="shared" class=""><code class="language-ocaml translatable">type%shared coord = { x : int; y : int; } [@@deriving json]
let%shared coord_data =
  Html.Custom_data.create_json ~name:&quot;coord&quot; [%derive.json: coord]</code></pre><h4> Injecting </h4><p>Custom data can be injected into HTML-trees of type <span><a href=".././../../eliom/latest/api/Eliom_content.Html#TYPEelt">Eliom_content.Html.elt</a></span> by the function <span><a href=".././../../eliom/latest/api/Eliom_content.Html.Custom_data#VALattrib">Eliom_content.Html.Custom_data.attrib</a></span>:
</p><pre class=""><code class="language-ocaml translatable">div ~a:[Html.Custom_data.attrib coord_data {x = 100; y = 200}] []</code></pre><h4> Reading/writing the DOM </h4><p>On the client side, custom data can be read from and written to JavaScript DOM
elements of type <span><a href=".././../../js_of_ocaml/latest/api/js_of_ocaml/Js_of_ocaml/Dom_html/class-type-element/#class-type-element">Js_of_ocaml.Dom_html.element</a></span>.
</p><p>Custom data can be read from a DOM-element with the function
<span><a href=".././api/client/Eliom_content.Html.Custom_data#VALget_dom">Eliom_content.Html.Custom_data.get_dom</a></span>.
If no respective custom data attribute can be found in the element
</p><ul><li> the <span class="monospace">default</span> value from creating the custom data is returned, if any, or
</li><li> an exception <span class="monospace">Not_found</span> is raised, otherwise.
</li></ul><p>The custom data of a DOM-element can be set with the function
<span><a href=".././api/client/Eliom_content.Html.Custom_data#VALset_dom">Eliom_content.Html.Custom_data.set_dom</a></span>.
</p><pre class=""><code class="language-ocaml translatable">[%client
    fun (div : Dom_html.element Js.t) -&gt;
      let i = Html.Custom_data.get_dom div coord_data in
      debug &quot;{x=%d; y=%d}&quot; i.x i.y;
      Html.Custom_data.set_dom div coord_data { x = i.x + 1; y = i.y - 1 }
  ]</code></pre><h4> Default value </h4><p>If a custom data is created with the optional argument <span class="monospace">default</span>, calls to
<span><a href=".././api/client/Eliom_content.Html.Custom_data#VALget_dom">Eliom_content.Html.Custom_data.get_dom</a></span> return that instead of throwing an
exception [Not_found].
</p><pre class=""><code class="language-ocaml translatable">let coord_data' =
    Html.Custom_data.create_json
       ~name:&quot;coord&quot; default:{x=0;y=0;} [%derive.json: my_data]</code></pre></article></div></div></body></html>
