<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ocsigen</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script><script src="/js/client.js"></script></head><body class="eliom 1.2.2 security"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Eliom
</p><ul class="mainmenu"><li class="mainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="mainmenu-current"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li></ul><div class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-current drawermainmenu-project"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigenserver/2.9/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-toolkit/1.1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-page"><a href="/projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href="/papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href="/credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href="/blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><div class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/1.2.2/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/1.2.2/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/1.2.2/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/1.2.2/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/1.2.2/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/1.2.2/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/1.2.2/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/1.2.2/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/1.2.2/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/1.2.2/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/1.2.2/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/1.2.2/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/1.2.2/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/1.2.2/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3></div></nav></div></div><button id="reason">Switch to </button><div class="twocols"><div class="leftcol"><div class="how-versions"><input id="how-versions-toggle" type="checkbox"/><label for="how-versions-toggle" class="how-versions-current">Version 1.2.2</label><div class="how-versions-all"><a href="/eliom/dev/manual/security">dev</a><a href="/eliom/6.3/manual/security">6.3</a><a href="/eliom/6.2/manual/security">6.2</a><a href="/eliom/6.1/manual/security">6.1</a><a href="/eliom/6.0/manual/security">6.0</a><a href="/eliom/5.0/manual/security">5.0</a><a href="/eliom/4.2/manual/security">4.2</a><a href="/eliom/4.1/manual/security">4.1</a><a href="/eliom/4.0/manual/security">4.0</a><a href="/eliom/3.0/manual/security">3.0</a><a href="/eliom/2.2.2/manual/security">2.2.2</a><a href="/eliom/2.1.1/manual/security">2.1.1</a><a href="/eliom/2.0.2/manual/security">2.0.2</a><a href="/eliom/2.0.1/manual/security">2.0.1</a><a href="/eliom/2.0/manual/security">2.0</a><a href="/eliom/1.3.4/manual/security">1.3.4</a><span class="how-versions-all-current">1.2.2</span><a href="/eliom/1.1.0/manual/security">1.1.0</a></div></div><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><div class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/1.2.2/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/1.2.2/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/1.2.2/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/1.2.2/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/1.2.2/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/1.2.2/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/1.2.2/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/1.2.2/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/1.2.2/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/1.2.2/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/1.2.2/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/1.2.2/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/1.2.2/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/1.2.2/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3></div></div><div class="rightcol"><h2>How to write secure applications with Eliom</h2><p>Eliom and Ocsigen server are taking in charge a lot of security issues automatically. This unburdens the programmer from having to think about most of security problems. This page details various possible designs flaws of web applications, how Eliom and Ocsigen server (possibly) protects you against a possible exploitation of these flaws, and where you should be careful. <em>Please help us maintaining this page, by sending us any comments.</em> </p><h3> The application only does client-side verification</h3><p>This is probably the biggest (and most dangerous) possible mistake. As the user has an entire control over the data sent to the server, <strong>never</strong> assume that the data sent by the client has been verified (even if there some checking function in Javascript or O'Browser).
Instead, reimplement all verifications server side.
</p><ul><li> As a (small) mitigating factor, Eliom automatically checks that the type of the parameters is correct.
</li><li> Suggested approach: use permissions to control if the user is allowed to perform an action. Then,
<ul><li> when creating a form, check if the user has the required permission (if not, you will usually display a message <em>insufficient permissions</em> instead of the form)
</li><li> in the service that answers to the form, perform the exact same check
</li></ul></li></ul><p>However, note that incorrect data will never crash the server.
</p><h3> Incorrect access controls</h3><p>This typically happens if authentication is badly implemented, or altogether missing in some places.
</p><ul><li> each URL should implement user verification. Never assume that the user
comes from a trusted url, for example because the url is secret.
</li><li> use a programmatic, layered model, which encodes the various user rights (for ex: admin/moderators/editors/connected users/anonymous).
Thus a compromised login will not compromise the entire application
</li><li> Do not leak information through erroneous login (such as <em>this login does not exist</em>). Always answer <em>Bad login or password</em>, using always the same string
</li><li> Do not permit too many near-simultaneous login attempts, either for the same login, or from the same IP. You can use the module Lwt_throttle to delay login, if too many connections are started.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Code_injection" class="ocsimore_phrasing_link">Code injection</a></h3><ul><li> Eliom modules are written in OCaml, which is a compiled language. This prevents all code injection possible with script languages.
</li><li> No sql injection is possible if you use Macaque or PGOCaml, which use PostgreSQL prepared statements.
</li><li> No Html injection is possible, as unsafe XHTML characters are always escaped before being written.
</li><li> Moreover, you can also receive X(HT)ML from the user in a fully safe way, using Ocamlduce types to check that the XML fragment is correct.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Directory_traversal" class="ocsimore_phrasing_link">Path traversal</a></h3><ul><li> The module <span><a class="ocsforge_doclink_ocsigenserver" href="/ocsigenserver/2.9/manual/extendconfiguration">Extendconfiguration </a></span> can be used to prevent access to files or entire directories, from both Staticmod and Eliom.
</li><li> Even if <span><a class="ocsforge_doclink_ocsigenserver" href="/ocsigenserver/2.9/manual/userconf">userconf</a></span> is activated, users can only expose their own files; see the <span class="teletype">localpath</span> option for details.
</li><li> Occurrences of the <span class="teletype">'..'</span> pattern appearing in Urls are automatically removed by the server
</li><li> Ocsigen automatically decode HTML entities in URLs, which protects against attacks based on quoted characters
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Session_fixation" class="ocsimore_phrasing_link">Session fixation</a></h3><ul><li> Ocsigen cookies are cryptographically generated, and cannot be guessed by the attacker. Thus the attacker cannot control, or supply, the cookie of the client.
</li><li> To be completely safe, do not issue tokens to anonymous users, or issue a new token as soon as a login/logout takes place
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" class="ocsimore_phrasing_link">Cross-site scripting (XSS)</a></h3><ul><li> most XSS attacks require code injection, from which you are automatically protected (see above)
</li><li> However, avoid at all costs to put user-supplied text in sensitive tags, including:
<ul><li> <span class="teletype">&lt;script&gt;</span> tags
</li><li> javascripts events such as <span class="teletype">onmouseover</span>
</li><li> inside <span class="teletype">&lt;meta&gt;</span> refresh tags
</li></ul></li><li> if the user can upload files, sanitize very severely html or text files (that can contain javascript). Moreover, IE sometimes disregards the content-type send by the server when it receives an image that is actually html, so you also need to check those files.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Cross-site_tracing" class="ocsimore_phrasing_link">Cross site tracing</a></h3><ul><li> Ocsigen server does not implement the trace directive.
</li><li> Furthermore, this attack is no longer really relevant, as current browsers protect against this kind of exploit
</li></ul><h3> Redirection attacks</h3><ul><li> Do not let the user supply the url to which a page redirects.
</li><li> Using Eliom, you can use non-attached co-services to implement functionalities such as login forms. This way:
<ul><li> you have a login form on each page
</li><li> you write the login code only once
</li><li> the user will not have control of any redirection
</li></ul></li></ul><h3> <a href="http://en.wikipedia.org/wiki/HTTP_header_injection" class="ocsimore_phrasing_link">Header injection</a></h3><ul><li> In general, do not let the user write text inside HTTP headers
</li><li> Likewise, do not let the user write its own value in a Cookie, as it gives access to this header
</li><li> To protect against badly written applications, Ocsigen sanitizes HTTP headers when it prints them: a space is inserted before any CR or LF occurring in the content of a header
</li></ul><h3> On-site request forgery</h3><ul><li> If a user has control of an url (especially one that is automatically read, such as an <span class="teletype">&lt;img&gt;</span>), remove characters such as <span class="teletype">?, &amp;, =</span>...
</li><li> As a mitigating factor, do not write GET services that actually perform actions. Use only POST, which cannot be invoked from an url.
</li></ul><h3 id="csrf"> <a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery" class="ocsimore_phrasing_link">Cross-site request forgery (XSRF)</a> <a class="backref" href="#csrf">&#182;</a></h3><ul><li> Eliom provides automatic protection: see the parameter <span class="teletype">csrf_safe</span> of coservices
</li><li> Alternatively, each time you generate a form, add a hidden field containing a unique id. The service that is called by the form must check that the id is valid.
</li></ul><h3> Denial of service</h3><ul><li> Use session groups to prevent a user from creating an unlimited number of sessions or dynamic services. (And do not attribute tokens to anonymous users). Even if you do not use session groups, Eliom limits the number of in memory sessions by sub network. <em>Warning: no limitation of the number of persistant sessions</em>. See the <span><a class="ocsforge_doclink_eliom" href="/eliom/1.2.2/manual/more_services#config">Services and page generation</a></span> chapter for more information about these limits.
</li></ul></div></div></div></body></html>
