<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Module Eliom_comet.​Channels </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script><script src="/js/client.js"></script></head><body class="eliom 2.1.1 server Eliom_comet.Channels"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Eliom
</p><ul class="mainmenu"><li class="mainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="mainmenu-current"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li></ul><div class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-current"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/ocsigenserver/2.9/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-toolkit/1.1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-page"><a href="/projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href="/papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href="/credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href="/blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><div class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/2.1.1/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/2.1.1/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/2.1.1/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/2.1.1/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/2.1.1/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/2.1.1/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/2.1.1/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/2.1.1/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/2.1.1/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/2.1.1/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/2.1.1/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/2.1.1/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/2.1.1/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/2.1.1/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3><h1>Server API</h1><h2><a href="/eliom/2.1.1/api/server/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.XHTML" class="ocsimore_phrasing_link">Eliom_pervasives.XHTML</a></h3><h2>Services creation and service handler</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output" class="ocsimore_phrasing_link">Eliom_output</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_references" class="ocsimore_phrasing_link">Eliom_references</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Extensions</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_atom" class="ocsimore_phrasing_link">Eliom_atom</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_openid" class="ocsimore_phrasing_link">Eliom_openid</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_module_types">Index of module types</a></span></h3><h1>Eliom client API</h1><h2><a href="/eliom/2.1.1/api/client/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_dom" class="ocsimore_phrasing_link">Eliom_dom</a></h3><h2>Services creation and manipulation</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client.Html5" class="ocsimore_phrasing_link">Eliom_client.Html5</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_module_types">Index of module types</a></span></h3></div></nav></div></div><div class="client-server-switch-wrapper"><div class="client-server-switch"><span class="server source">This is server API</span> API (go to <a class="client target" href="/eliom/2.1.1/api/client/Eliom_comet.Channels">client</a>)</div></div><button id="reason">Switch to </button><div class="twocols"><div class="leftcol"><div class="how-versions"><input id="how-versions-toggle" type="checkbox"/><label for="how-versions-toggle" class="how-versions-current">Version 2.1.1</label><div class="how-versions-all"><a href="/eliom/dev/api/server/Eliom_comet.Channels">dev</a><a href="/eliom/6.3/api/server/Eliom_comet.Channels">6.3</a><a href="/eliom/6.2/api/server/Eliom_comet.Channels">6.2</a><a href="/eliom/6.1/api/server/Eliom_comet.Channels">6.1</a><a href="/eliom/6.0/api/server/Eliom_comet.Channels">6.0</a><a href="/eliom/5.0/api/server/Eliom_comet.Channels">5.0</a><a href="/eliom/4.2/api/server/Eliom_comet.Channels">4.2</a><a href="/eliom/4.1/api/server/Eliom_comet.Channels">4.1</a><a href="/eliom/4.0/api/server/Eliom_comet.Channels">4.0</a><a href="/eliom/3.0/api/server/Eliom_comet.Channels">3.0</a><a href="/eliom/2.2.2/api/server/Eliom_comet.Channels">2.2.2</a><span class="how-versions-all-current">2.1.1</span><a href="/eliom/2.0.2/api/server/Eliom_comet.Channels">2.0.2</a><a href="/eliom/2.0.1/api/server/Eliom_comet.Channels">2.0.1</a><a href="/eliom/2.0/api/server/Eliom_comet.Channels">2.0</a><a href="/eliom/1.3.4/api/server/Eliom_comet.Channels">1.3.4</a><a href="/eliom/1.2.2/api/server/Eliom_comet.Channels">1.2.2</a><a href="/eliom/1.1.0/api/server/Eliom_comet.Channels">1.1.0</a></div></div><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><div class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/2.1.1/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/2.1.1/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/2.1.1/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/2.1.1/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/2.1.1/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/2.1.1/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/2.1.1/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/2.1.1/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/2.1.1/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/2.1.1/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/2.1.1/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/2.1.1/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/2.1.1/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/2.1.1/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3><h1>Server API</h1><h2><a href="/eliom/2.1.1/api/server/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.XHTML" class="ocsimore_phrasing_link">Eliom_pervasives.XHTML</a></h3><h2>Services creation and service handler</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output" class="ocsimore_phrasing_link">Eliom_output</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_references" class="ocsimore_phrasing_link">Eliom_references</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Extensions</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_atom" class="ocsimore_phrasing_link">Eliom_atom</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_openid" class="ocsimore_phrasing_link">Eliom_openid</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_module_types">Index of module types</a></span></h3><h1>Eliom client API</h1><h2><a href="/eliom/2.1.1/api/client/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_dom" class="ocsimore_phrasing_link">Eliom_dom</a></h3><h2>Services creation and manipulation</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client.Html5" class="ocsimore_phrasing_link">Eliom_client.Html5</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_module_types">Index of module types</a></span></h3></div></div><div class="rightcol"><h1>Module <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels">Eliom_comet.​Channels</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">Channels</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>Basic primitives needed for server push.
</p><hr/><pre class="ocsforge_color odocwiki_code" id="TYPEt"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'a</span> <span class="odocwiki_name">t</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">v t</span> is the type of server-to-client communication channels
transporting data of type <span class="odocwiki_inlinecode">v</span></p></div><pre class="ocsforge_color odocwiki_code" id="TYPEcomet_scope"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">comet_scope</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type">[ `Client_process of <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_common#TYPEscope_name">Eliom_common.scope_name</a></span> | `Site ]</span></pre><pre class="ocsforge_color odocwiki_code" id="VALcreate"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?scope:</span>[&lt; <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels#TYPEcomet_scope">comet_scope</a></span> ] <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?size:</span>int <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_uid">Lwt_stream</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels#TYPEt">t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">create s</span> returns a channel sending values from <span class="odocwiki_inlinecode">s</span>.
</p><p>There are two kind of channels created depending on the given
scope (defaults to <span class="odocwiki_inlinecode">Eliom_common.comet_client_process</span>).
</p><p>With scope <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_common#VALsite">Eliom_common.​site</a></span> all users knowing the name of
the channel can access it. Only one message queue is created: it
is what we call a stateless channel in the sense that the memory
used by the channel does not depend on the number of users.  The
channel can be reclaimed by the GC when there is no more reference to it.
The buffer channel has a limited buffer of size <span class="odocwiki_inlinecode">size</span> (default:
1000). If the client requests too old messages, exception
<span class="odocwiki_inlinecode">Eliom_coment.Channel_full</span> will be raised (on client side).
</p><p>With a scope of level <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_common#TYPEclient_process_scope">Eliom_common.​client_process_scope</a></span> the
channel can only be accessed by the user who created it. It
can only be created when client application data is
available. The eliom service created to communicate with the
client is only available in the scope of the client process. To
avoid memory leak when the client do not read sent data,
the channel has a limited <span class="odocwiki_inlinecode">size</span>. When a channel is full, no
data can be read from it anymore.
</p><p>A channel can be used only once on client side. To be able
to receive the same data multiple times on client side, use
<span class="odocwiki_inlinecode">create (Lwt_stream.clone s)</span> every time.
</p><p>To enforce the limit on the buffer size, the data is read into
<span class="odocwiki_inlinecode">stream</span> as soon as possible: If you want a channel that reads
data on the stream only when the client requests it, use
<span class="odocwiki_inlinecode">create_unlimited</span> instead, but be careful of memory leaks.</p></div><pre class="ocsforge_color odocwiki_code" id="VALcreate_unlimited"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create_unlimited</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?scope:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_common#TYPEclient_process_scope">Eliom_common.client_process_scope</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_uid">Lwt_stream</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels#TYPEt">t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">create_unlimited s</span> creates a channel which does not read
immediately on the stream. It is read only when the client
requests it: use it if the data you send depends on the time of
the request (for instance the number of unread mails). Be
careful, the size of this stream is not limited: if the size of
the stream increases and your clients don't read it, you may have
memory leaks.</p></div><pre class="ocsforge_color odocwiki_code" id="VALcreate_newest"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create_newest</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">?name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_uid">Lwt_stream</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels#TYPEt">t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">create_newest s</span> is similar to <span class="odocwiki_inlinecode">create
~scope:Eliom_common.site s</span> but only the last message is
returned to the client.</p></div><pre class="ocsforge_color odocwiki_code" id="VALexternal_channel"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">external_channel</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?history:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?newest:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">prefix:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_comet.Channels#TYPEt">t</a></span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">external_channel ~prefix ~name ()</span> declares an external
channel. The channel was created by an instance of Eliom serving
the prefix <span class="odocwiki_inlinecode">prefix</span> (the prefix configured in the &lt;site&gt; tag of
the configuration file). The channel was named by <span class="odocwiki_inlinecode">name</span>. Both
servers must run the exact same version of Eliom.
</p><p>The optional <span class="odocwiki_inlinecode">newest</span> parameters tells whether the channel is a
new one. If the channel is not new, <span class="odocwiki_inlinecode">history</span> is the maximum
number of messages retrieved at the first request. The default
is <span class="odocwiki_inlinecode">1</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALwait_timeout"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">wait_timeout</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?scope:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_common#TYPEclient_process_scope">Eliom_common.client_process_scope</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> float <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">wait_timeout ~scope time</span> waits for a period of inactivity of
length <span class="odocwiki_inlinecode">time</span> in the <span class="odocwiki_inlinecode">scope</span>. Only activity on stateful
channels is taken into accounts.
</p><p>The default <span class="odocwiki_inlinecode">scope</span> is <span class="odocwiki_inlinecode">Eliom_common.comet_client_process</span>.</p></div></div></div></div></body></html>
