<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Module Eliom_openid </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script><script src="/js/client.js"></script></head><body class="eliom 2.1.1 server Eliom_openid"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Eliom
</p><ul class="mainmenu"><li class="mainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="mainmenu-current"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li></ul><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-current drawermainmenu-project"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigenserver/2.9/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-toolkit/1.1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-page"><a href="/projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href="/papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href="/credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href="/blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/2.1.1/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/2.1.1/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/2.1.1/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/2.1.1/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/2.1.1/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/2.1.1/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/2.1.1/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/2.1.1/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/2.1.1/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/2.1.1/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/2.1.1/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/2.1.1/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/2.1.1/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/2.1.1/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3><h1>Server API</h1><h2><a href="/eliom/2.1.1/api/server/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.XHTML" class="ocsimore_phrasing_link">Eliom_pervasives.XHTML</a></h3><h2>Services creation and service handler</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output" class="ocsimore_phrasing_link">Eliom_output</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_references" class="ocsimore_phrasing_link">Eliom_references</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Extensions</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_atom" class="ocsimore_phrasing_link">Eliom_atom</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_openid" class="ocsimore_phrasing_link">Eliom_openid</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_module_types">Index of module types</a></span></h3><h1>Eliom client API</h1><h2><a href="/eliom/2.1.1/api/client/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_dom" class="ocsimore_phrasing_link">Eliom_dom</a></h3><h2>Services creation and manipulation</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client.Html5" class="ocsimore_phrasing_link">Eliom_client.Html5</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_module_types">Index of module types</a></span></h3></nav></nav></aside></div><div class="client-server-switch-wrapper" id="smallscreencsswitch"><div class="client-server-switch"><span class="server source">This is server API</span> (go to <a class="client target" href="/eliom/2.1.1/api/client/Eliom_openid">client</a>)</div></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value="/eliom/dev/api/server/Eliom_openid">dev</option><option value="/eliom/6.3/api/server/Eliom_openid">6.3</option><option value="/eliom/6.2/api/server/Eliom_openid">6.2</option><option value="/eliom/6.1/api/server/Eliom_openid">6.1</option><option value="/eliom/6.0/api/server/Eliom_openid">6.0</option><option value="/eliom/5.0/api/server/Eliom_openid">5.0</option><option value="/eliom/4.2/api/server/Eliom_openid">4.2</option><option value="/eliom/4.1/api/server/Eliom_openid">4.1</option><option value="/eliom/4.0/api/server/Eliom_openid">4.0</option><option value="/eliom/3.0/api/server/Eliom_openid">3.0</option><option value="/eliom/2.2.2/api/server/Eliom_openid">2.2.2</option><option class="how-versions-all-current">2.1.1</option><option value="/eliom/2.0.2/api/server/Eliom_openid">2.0.2</option><option value="/eliom/2.0.1/api/server/Eliom_openid">2.0.1</option><option value="/eliom/2.0/api/server/Eliom_openid">2.0</option><option value="/eliom/1.3.4/api/server/Eliom_openid">1.3.4</option><option value="/eliom/1.2.2/api/server/Eliom_openid">1.2.2</option><option value="/eliom/1.1.0/api/server/Eliom_openid">1.1.0</option></select><div class="client-server-switch-wrapper" id="largescreencsswitch"><div class="client-server-switch"><span class="server source">This is server API</span> (go to <a class="client target" href="/eliom/2.1.1/api/client/Eliom_openid">client</a>)</div></div><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><nav class="how-doctree"><h1>Eliom's Reference manual</h1><h2><a href="/eliom/2.1.1/manual/intro" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server side concepts</h2><h3>Services</h3><h4><a href="/eliom/2.1.1/manual/services" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/2.1.1/manual/params" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/2.1.1/manual/outputs" class="ocsimore_phrasing_link">Writing service handlers</a></h4><h4><a href="/eliom/2.1.1/manual/links" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/2.1.1/manual/state" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/2.1.1/manual/config" class="ocsimore_phrasing_link">Configuring and running Eliom</a></h3><h2>Client-server application</h2><h3><a href="/eliom/2.1.1/manual/client" class="ocsimore_phrasing_link">Applications</a></h3><h3><a href="/eliom/2.1.1/manual/client-communication" class="ocsimore_phrasing_link">Client/server communication</a></h3><h3><a href="/eliom/2.1.1/manual/client-compiling" class="ocsimore_phrasing_link">Compilation process</a></h3><h2>Miscellaneous</h2><h3><a href="/eliom/2.1.1/manual/html" class="ocsimore_phrasing_link">Writing HTML</a></h3><h3><a href="/eliom/2.1.1/manual/security" class="ocsimore_phrasing_link">Security considerations</a></h3><h3><a href="/eliom/2.1.1/manual/wrapping" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h3><a href="/eliom/2.1.1/manual/examples" class="ocsimore_phrasing_link">Examples</a></h3><h1>Server API</h1><h2><a href="/eliom/2.1.1/api/server/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_common" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_config" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/2.1.1/api/server/Eliom_request_info" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_pervasives.XHTML" class="ocsimore_phrasing_link">Eliom_pervasives.XHTML</a></h3><h2>Services creation and service handler</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_parameters" class="ocsimore_phrasing_link">Eliom_parameters</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_output" class="ocsimore_phrasing_link">Eliom_output</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_references" class="ocsimore_phrasing_link">Eliom_references</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_state" class="ocsimore_phrasing_link">Eliom_state</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_react" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Extensions</h2><h3><a href="/eliom/2.1.1/api/server/Eliom_atom" class="ocsimore_phrasing_link">Eliom_atom</a></h3><h3><a href="/eliom/2.1.1/api/server/Eliom_openid" class="ocsimore_phrasing_link">Eliom_openid</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/index_module_types">Index of module types</a></span></h3><h1>Eliom client API</h1><h2><a href="/eliom/2.1.1/api/client/Eliom_pervasives" class="ocsimore_phrasing_link">Eliom_pervasives</a></h2><h2>HTML</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_pervasives.HTML5" class="ocsimore_phrasing_link">Eliom_pervasives.HTML5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_output.Html5" class="ocsimore_phrasing_link">Eliom_output.Html5</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_dom" class="ocsimore_phrasing_link">Eliom_dom</a></h3><h2>Services creation and manipulation</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_services" class="ocsimore_phrasing_link">Eliom_services</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client" class="ocsimore_phrasing_link">Eliom_client</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_client.Html5" class="ocsimore_phrasing_link">Eliom_client.Html5</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/2.1.1/api/client/Eliom_bus" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/2.1.1/api/client/Eliom_comet" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_types">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_values">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_modules">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/client/index_module_types">Index of module types</a></span></h3></nav></nav><article class="rightcol"><h1>Module <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid">Eliom_openid</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">Eliom_openid</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>OpenID identification
</p><hr/><p>This module implements the Relying Party of the OpenID specification,
in stateful mode.
</p><h2 id="2_Librarydescription">Library description <a class="backref" href="#2_Librarydescription">&#182;</a></h2><p>The library provides means to authenticate an user
to a remote provider using the OpenID protocol.
Basically, you need to ask the user its OpenID url, and
the fields you want to require (or none, if you just want to
authenticate an user), along with other information.
</p><p>The library uses an &quot;hidden service&quot; that is needed when the provider
redirects back to your site. This service is registered in the library, all you have
to do is to give a path for that service and a default handler
(if the user connects to that service without being in an authentication process.)
Here is a short example of how to use the library

</p><pre class=""><code class="language-ocaml translatable">open Eliom_openid
let messages = Eliom_state.create_volatile_table ()
(* The login form *)
let login_form = Eliom_services.new_service
  ~path:[&quot;login-form&quot;]
  ~get_params: Eliom_parameters.unit
  ()

(* Initialize the library, and getting the authenticate function *)
let authenticate = Eliom_openid.init ~path:[&quot;__openid_return_service&quot;]
    ~f: (fun _ _ -&gt; Eliom_output.Redirection.send login_form)

(* Create the handler for the form *)
(* We have to use Eliom_output.String_redirection as we
   redirect the user to her provider *)
let form_handler = Eliom_output.String_redirection.register_new_post_coservice
    ~fallback: login_form
    ~post_params: (Eliom_parameters.string &quot;url&quot;)
    (fun _ url -&gt;
       authenticate
    ~max_auth_age: 4 (* Requires that if the user logged in more that 4 seconds ago
                        he needs to relog in *)
    ~required: [Eliom_openid.Email] (* Requires his e-mail *)
    ~immediate: false
   url
   (fun result -&gt;
     let string =
       match result with
         | Setup_needed -&gt; &quot;setup needed&quot; | Canceled -&gt; &quot;canceled&quot;
         | Result result -&gt;
           try List.assoc Email result.fields with Not_found -&gt; &quot;No e-mail :(&quot;
     in
     Eliom_state.set_volatile_session_data ~table:messages string;
     Eliom_output.Redirection.send login_form))

open XHTML
let _ = Eliom_output.Xhtml.register
    ~service: login_form
    (fun _ _ -&gt;
    (match Eliom_state.get_volatile_session_data ~table: messages () with
     | Eliom_state.Data s -&gt;
       Eliom_state.discard () &gt;&gt;= fun () -&gt;
       Lwt.return [p [pcdata (&quot;Authentication result: &quot;^ s)]]
     | _ -&gt; Lwt.return []) &gt;&gt;= fun message -&gt;
    let form =
    Eliom_output.Xhtml.post_form ~service:form_handler
      (fun url -&gt;
        [p [pcdata &quot;Your OpenID identifier: &quot;;
            Eliom_output.Xhtml.string_input ~input_type:`Text ~name:url ();
            Eliom_output.Xhtml.string_input ~input_type:`Submit ~value:&quot;Login&quot; ();
           ]]) ()
    in
    Lwt.return
      (html
           (head (title (pcdata &quot;A sample test&quot;)) [])
           (body
              (message @ [form]))))</code></pre><h2 id="2_Documentation">Documentation <a class="backref" href="#2_Documentation">&#182;</a></h2><h3 id="3_Miscallenous">Miscallenous <a class="backref" href="#3_Miscallenous">&#182;</a></h3><pre class="ocsforge_color odocwiki_code" id="TYPEopenid_error"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">openid_error</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_variants"><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_XRDS_File</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string * string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The provider XRDS file was not valid</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Discovery_Error</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string * string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>An error occured during the discovery of the provider</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Missing_parameter</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The remote server forgot a parameter in its request</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_signature</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string * string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>We disagree with the server's signature</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_association</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>We were unable to associate with a provider</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_argument</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string * string * string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The argument provided were not set to a correct value</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Server_error</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The server threw an explicit error</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_answer</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The answer code was not correct</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Invalid_html_doc</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></span></span></span></pre><div class="odocwiki_info"><p>Error that may happen when identifiying an user</p></div><p>An error occured during the parsing of an user url in html format
</p><pre class="ocsforge_color odocwiki_code" id="VALstring_of_openid_error"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">string_of_openid_error</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEopenid_error">openid_error</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string</span></pre><div class="odocwiki_info"><p>Prettyprint an OpenID Error</p></div><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONError"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">Error</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEopenid_error">openid_error</a></span></span></pre><div class="odocwiki_info"><p>Exception thrown by this module's function.</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEfield"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">field</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_variants"><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Email</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Fullname</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">DateOfBirth</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">PostCode</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Timezone</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Language</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Country</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Gender</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Nickname</span></span></span></span></pre><div class="odocwiki_info"><p>A field you can request to the provider</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEextension"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'a</span> <span class="odocwiki_name">extension</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_delimiter">{</span>
<span class="odocwiki_record"><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">headers:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>string * string<span class="ocsforge_color_delimiter">)</span> list</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">parse:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>string * string<span class="ocsforge_color_delimiter">)</span> list <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span><span class="ocsforge_color_delimiter">;</span></span></span></span><span class="ocsforge_color_delimiter">}</span></pre><div class="odocwiki_info"><p>An extension yielding values of type 'a</p></div><pre class="ocsforge_color odocwiki_code" id="VALsreg"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">sreg</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?policy_url:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">required:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">optional:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> * string<span class="ocsforge_color_delimiter">)</span> list <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span></span></pre><div class="odocwiki_info"><p>The SREG extension
<strong>See also</strong> <a href="http://openid.net/specs/openid-simple-registration-extension-1_1-01.html" class="ocsimore_phrasing_link">SREG</a><br/></p></div><pre class="ocsforge_color odocwiki_code" id="VALax"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">ax</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">required:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">optional:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> * string<span class="ocsforge_color_delimiter">)</span> list <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span></span></pre><div class="odocwiki_info"><p>The AX extension
<strong>See also</strong> <a href="http://openid.net/specs/openid-attribute-exchange-1_0.html" class="ocsimore_phrasing_link">AX</a><br/></p></div><pre class="ocsforge_color odocwiki_code" id="TYPEpape"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">pape</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_delimiter">{</span>
<span class="odocwiki_record"><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">auth_time:</span> <span class="odocwiki_type">string option</span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The time at which the user last logged in</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">policies:</span> <span class="odocwiki_type">string list option</span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>A list of policies (url) describing your usage of the data</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">nist_level:</span> <span class="odocwiki_type">int option</span><span class="ocsforge_color_delimiter">;</span></span></span></span><span class="ocsforge_color_delimiter">}</span></pre><div class="odocwiki_info"><p>The pape data returned by the server</p></div><pre class="ocsforge_color odocwiki_code" id="VALpape"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">pape</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?max_auth_age:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?auth_policies:</span>string list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEpape">pape</a></span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span></span></pre><div class="odocwiki_info"><p>The nist level</p></div><pre class="ocsforge_color odocwiki_code" id="VAL( *** )"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">( *** )</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  'a <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  'b <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>'a * 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEextension">extension</a></span></span></pre><div class="odocwiki_info"><p>The PAPE extension.
<strong>See also</strong> <a href="http://openid.net/specs/openid-provider-authentication-policy-extension-1_0-01.html" class="ocsimore_phrasing_link">PAPE</a><br/></p></div><p>Product of two extension
</p><pre class="ocsforge_color odocwiki_code" id="TYPEauthentication_result"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'a</span> <span class="odocwiki_name">authentication_result</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_variants"><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Canceled</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The user canceled the login (or failed)</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Setup_needed</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The provider has not enough information to complete an immediate
request. Only returned when using an immediate authentication.</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_variant"><span class="odocwiki_variant_constr"><span class="ocsforge_color_keyword"> |</span> <span class="ocsforge_color_uid">Result</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">'a</span></span></span></span></pre><div class="odocwiki_info"><p>The result of an authentication.</p></div><p>All went ok.
</p><h3 id="3_Lowlevelinterface">Low-level interface. <a class="backref" href="#3_Lowlevelinterface">&#182;</a></h3><pre class="ocsforge_color odocwiki_code" id="VALperform_discovery"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">perform_discovery</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>string * string option<span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Perform discovery on an user-supplied url</p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module type</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid.HiddenServiceInfo">HiddenServiceInfo</a></span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid.HiddenServiceInfo">..</a></span><span class="ocsforge_color_keyword">end</span></pre><div class="odocwiki_info"><p>Information about the hidden service</p></div><p>The function called when an user connects to the hidden service
(not that hidden) without being in an identication process.
Typically you should redirect the user to the login page.
</p><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid.Make">Make</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_sig_block"><span class="ocsforge_color_keyword">functor</span> <span class="ocsforge_color_delimiter">(</span>S <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid.HiddenServiceInfo">HiddenServiceInfo</a></span></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> <br/>  <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid.Make">..</a></span><span class="ocsforge_color_keyword">end</span></span></pre><div class="odocwiki_info"><p>This functor build a hidden service that will be used
to receive the remote server's data.</p></div><p>Authenticate an user.
</p><ul><li> mode: can be <span class="odocwiki_inlinecode">checkid_setup</span> or <span class="odocwiki_inlinecode">checkid_immediate</span>
whether you want immediate identification or not.
</li><li> ext: the extensions you want to use.
</li><li> handler: the handler called with the result of the authentication.
</li><li> discovery: The discovery information
In return you get an URI you have to redirect the user to.
</li></ul><h3 id="3_Highlevelinterface">High-level interface <a class="backref" href="#3_Highlevelinterface">&#182;</a></h3><p>The high-level interface takes care of creating
the extension you want, without to use them directly.
It yields a <span class="odocwiki_inlinecode">result</span>.
</p><pre class="ocsforge_color odocwiki_code" id="TYPEresult"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">result</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_delimiter">{</span>
<span class="odocwiki_record"><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">fields:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> * string<span class="ocsforge_color_delimiter">)</span> list</span><span class="ocsforge_color_delimiter">;</span></span><span class="odocwiki_comments"><span class="odocwiki_comments_open">(*</span> <span>The fields you requested</span><span class="odocwiki_comments_close"> *)</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">pape:</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEpape">pape</a></span></span><span class="ocsforge_color_delimiter">;</span></span></span></span><span class="ocsforge_color_delimiter">}</span></pre><div class="odocwiki_info"><p>The result yielded by the authentication process</p></div><p>The pape information
</p><pre class="ocsforge_color odocwiki_code" id="TYPEcheck_fun"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">check_fun</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?immediate:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?policy_url:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?max_auth_age:</span>int <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?auth_policies:</span>string list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?required:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?optional:</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEfield">field</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEresult">result</a></span> <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEauthentication_result">authentication_result</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>   <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEbrowser_content">Eliom_output.browser_content</a></span>, <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEhttp_service">Eliom_output.http_service</a></span><span class="ocsforge_color_delimiter">)</span><br/>   <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEkind">Eliom_output.kind</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_pervasives.Url#TYPEt">Eliom_pervasives.Url.t</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>The type of the authenticate function.
</p><ul><li> immediate: whether to use immediate identification or not (default: true)
</li><li> policy_url: an optional policy url to describe what you do with the data (sreg) (default:none)
</li><li> required: optional fields you really need (although the provier may not provide them) (default:empty)
</li><li> optional: optional fields you don't really need (default: empty)
</li><li> max_auth_age: Requires that the user logged in less than <span class="odocwiki_inlinecode">n</span> seconds ago. (default: up to the provider)
</li><li> auth_policies: A list of url describing your policies regarding the data (default: empty)
</li><li> the url the user gave you
</li><li> an handler, that'll be called after checking the parameters with the result
and the server params of the GET request. You can send whatever page you want
but you should redirect the user to a page so he can't bookmark it, or
send some piece of html to interface with javascript.</li></ul></div><pre class="ocsforge_color odocwiki_code" id="VALinit"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">init</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">path:</span>string list <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">f:</span><span class="ocsforge_color_delimiter">(</span><span class="ocsforge_color_delimiter">(</span>string * string<span class="ocsforge_color_delimiter">)</span> list <span class="ocsforge_color_delimiter">-&gt;</span><br/>     unit <span class="ocsforge_color_delimiter">-&gt;</span><br/>     <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEbrowser_content">Eliom_output.browser_content</a></span>, <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEhttp_service">Eliom_output.http_service</a></span><span class="ocsforge_color_delimiter">)</span><br/>     <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_output#TYPEkind">Eliom_output.kind</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/api/server/Eliom_openid#TYPEcheck_fun">check_fun</a></span></span></pre><div class="odocwiki_info"><p>Init the OpenID for your site.
Takes a path and a handler for the hidden service</p></div></article></div></div></body></html>
